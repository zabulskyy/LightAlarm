#include "main.h"
#include "stm32f3xx_hal.h"
#include "i2c.h"
#include "gpio.h"

#define I2C1_DEVICE_ADDRESS      0x68
uint8_t xBuffer[16];
/*
void enable_alarm(){

	uint8_t one[] = {0};
	HAL_I2C_Mem_Write(&hi2c1, 0x68*2, 0xE, 1, one, 1, 500);
	return;
}*/
void set_alarm(int dhr, int hr, int dmn, int mn){

	//enable_alarm();
	uint8_t alarm_seconds[] =   { 0 << 4 		| 0		| 0 << 7 };
	uint8_t alarm_minutes[] =   { dmn << 4 		| mn 	| 0 << 7 };
	uint8_t alarm_hours[] =     { dhr << 4 		| hr 	| 0 << 7 };
	uint8_t alarm_week_day[] =  { 1 << 6 		| 0 	| 1 << 7 };

	HAL_I2C_Mem_Write(&hi2c1, 0x68*2, 7,   1, alarm_seconds,  1, 500);	// seconds
	HAL_I2C_Mem_Write(&hi2c1, 0x68*2, 8,   1, alarm_minutes,  1, 500);	// minutes
	HAL_I2C_Mem_Write(&hi2c1, 0x68*2, 9,   1, alarm_hours,    1, 500);	// hours
	HAL_I2C_Mem_Write(&hi2c1, 0x68*2, 0xA, 1, alarm_week_day, 1, 500);	// weekday

	return;
}
/*
uint8_t is_time_to_alarm(){
	HAL_I2C_Mem_Read(&hi2c1, 0x68*2, 0, 1, xBuffer, 0x10, 500);
	return xBuffer[0xF]&0xF;
}*/
/*
void disable_alarm(){

	uint8_t zero[] = {0};
	HAL_I2C_Mem_Write(&hi2c1, 0x68*2, 0xE, 1, zero, 1, 500);
	return;
}*/


